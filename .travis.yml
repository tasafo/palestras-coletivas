dist: trusty
sudo: false
language: ruby
rvm:
- 2.6.3
branches:
  only:
  - master
env:
  global:
  - MONGODB_HOST=localhost:27017
  - REDIS_URL=redis://localhost:6379
services:
- mongodb
- redis-server
addons:
  apt:
    packages:
    - qt5-default
    - libqt5webkit5-dev
    - gstreamer1.0-plugins-base
    - gstreamer1.0-tools
    - gstreamer1.0-x
    - xvfb
    - libmagickwand-dev
before_install:
- "echo 'gem: --no-document' > ~/.gemrc"
- "echo '--colour' > ~/.rspec"
before_script:
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
- chmod +x ./cc-test-reporter
- ./cc-test-reporter before-build
script:
- sudo sh -c "dbus-uuidgen > /etc/machine-id"
- xvfb-run -a bundle exec rails spec:coverage
after_script:
- ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT
deploy:
  provider: heroku
  app: palestrascoletivas
  api_key:
    secure: D4u/2YKMuSvVrKFNbEWJjOqVTMuuDILS8GPjEVXiqQVjH3Tehz1tMY9hflsp3NzgVUYBPLRyZm0eLskzrVyrcitSX6qhKhf7f8G1f7vmS6eTtSIPFJkU1ysX/rBzJsK8qR3AIqsA4B0HTVPp13dP4cP1DN3WDPxvIDUaXzrD7Qo=
